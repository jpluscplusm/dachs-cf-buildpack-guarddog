#!/usr/bin/ruby

require 'net/http'
require 'fileutils'

dirname = ARGV[0]

FileUtils.touch(File.join(dirname, '.guarddog'))

Net::HTTP.start('s3-eu-west-1.amazonaws.com') do |http|
    resp = http.get('/dachs-haproxy-build/haproxy')
    open(File.join(dirname, 'haproxy'), 'wb') do |file|
        file.write(resp.body)
    end
end

puts "Download of haproxy finished"
